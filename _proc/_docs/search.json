[
  {
    "objectID": "core.html",
    "href": "core.html",
    "title": "core",
    "section": "",
    "text": "Chronicle collects and stores logs and metrics in a series of parquet files.\nUse read_chronicle() to read either logs or metrics, by specifying the path to the parquet set you need.\nThe file tree looks like this, with logs and metrics in separate folders inside v1.\n.\n└── v1/\n    ├── logs/\n    └── metrics/\nInside both logs and metrics the data is stored by date, separated by year, month and day.\n.\n└── v1/\n    ├── logs/\n    │   └── 2023/\n    │       ├── 02/\n    │       │   ├── 01\n    │       │   ├── 02\n    │       │   ├── 03\n    │       │   ├── 04\n    │       │   ├── 05\n    │       │   └── ...\n    │       ├── 03\n    │       ├── 04\n    │       └── ...\n    └── metrics/\n        └── 2023/\n            ├── 02/\n            │   ├── 01\n            │   ├── 02\n            │   ├── 03\n            │   ├── 04\n            │   ├── 05\n            │   └── ...\n            ├── 03\n            ├── 04\n            └── ...\n\nsource\n\n\n\n read_chronicle (path:str)\n\nRead a chronicle parquet file into a polars dataframe.\n\n\n\n\nType\nDetails\n\n\n\n\npath\nstr\nPath to dataset\n\n\nReturns\nDataFrame\n\n\n\n\n\nz = read_chronicle(\"./data/v1/metrics\")\nassert type(z) == pl.dataframe.frame.DataFrame\n\nz = read_chronicle(\"./data/v1/logs\")\nassert type(z) == pl.dataframe.frame.DataFrame"
  },
  {
    "objectID": "core.html#analyse-metrics",
    "href": "core.html#analyse-metrics",
    "title": "core",
    "section": "Analyse metrics",
    "text": "Analyse metrics\n\nsource\n\nChronicleMetrics\n\n ChronicleMetrics (df:polars.dataframe.frame.DataFrame)\n\nInitialise a chronicle metrics class\n\n\n\n\nType\nDetails\n\n\n\n\ndf\nDataFrame\nA polars DataFrame\n\n\nReturns\nDataFrame\n\n\n\n\n\nsource\n\n\nChronicleMetrics.describe\n\n ChronicleMetrics.describe ()\n\nReads metrics dataframe and returns a pandas dataframe with summary of service, name and description of all metrics\nThe metrics data has a single row for each collected metric.\nUse describe() to get a DataFrame of the unique metrics in the metrics data, containing the service, name and description of each metric.\n\nm = read_chronicle(\"./data/v1/metrics/\").metrics.describe()\nassert list(m) == ['service', 'name', 'description', 'value_column']\nm\n\n\n\n\n\n  \n    \n      \n      service\n      name\n      description\n      value_column\n    \n  \n  \n    \n      0\n      connect-metrics\n      rsconnect_system_memory_available\n      Graphite metric rsconnect_system_memory_available\n      value_float\n    \n    \n      1\n      connect-metrics\n      rsconnect_system_memory_total\n      Graphite metric rsconnect_system_memory_total\n      value_float\n    \n    \n      2\n      connect-metrics\n      rsconnect_system_memory_used\n      Graphite metric rsconnect_system_memory_used\n      value_float\n    \n    \n      3\n      workbench-metrics\n      rstudio_system_memory_available\n      Graphite metric rstudio_system_memory_available\n      value_float\n    \n    \n      4\n      workbench-metrics\n      rstudio_system_memory_total\n      Graphite metric rstudio_system_memory_total\n      value_float\n    \n    \n      5\n      workbench-metrics\n      rstudio_system_memory_used\n      Graphite metric rstudio_system_memory_used\n      value_float\n    \n  \n\n\n\n\n\nsource\n\n\nChronicleMetrics.filter\n\n ChronicleMetrics.filter (name:str, alias:str=None)\n\nExtract a single metric from a metrics dataframe\n\n\n\n\nType\nDefault\nDetails\n\n\n\n\nname\nstr\n\nname of metric to extract\n\n\nalias\nstr\nNone\nalias to use for new column\n\n\nReturns\nDataFrame\n\n\n\n\n\nThe name argument is used to filter the DataFrame on the name column.\n\nm = read_chronicle(\"./data/v1/metrics/\").metrics.filter(\"rsconnect_system_memory_used\")\nassert type(m) == pd.DataFrame\nassert list(m) == ['host', 'timestamp', 'rsconnect_system_memory_used']\n\nm = read_chronicle(\"./data/v1/metrics/\").metrics.filter(\"rsconnect_system_memory_used\", \"memory\")\nassert type(m) == pd.DataFrame\nassert list(m) == ['host', 'timestamp', 'memory']\n\nm\n\n\n\n\n\n  \n    \n      \n      host\n      timestamp\n      memory\n    \n  \n  \n    \n      0\n      rstudio-connect-68785f94cc-qzvrm\n      2023-04-03 16:00:29.980\n      1.170264e+09\n    \n    \n      1\n      rstudio-connect-68785f94cc-qzvrm\n      2023-04-03 16:01:29.980\n      1.187889e+09\n    \n    \n      2\n      rstudio-connect-68785f94cc-qzvrm\n      2023-04-03 16:02:29.980\n      1.188659e+09\n    \n    \n      3\n      rstudio-connect-68785f94cc-qzvrm\n      2023-04-03 16:03:29.980\n      1.252348e+09\n    \n    \n      4\n      rstudio-connect-68785f94cc-qzvrm\n      2023-04-03 16:04:29.980\n      1.259856e+09\n    \n    \n      ...\n      ...\n      ...\n      ...\n    \n    \n      475\n      rstudio-connect-68785f94cc-qzvrm\n      2023-04-03 23:55:29.980\n      7.842284e+08\n    \n    \n      476\n      rstudio-connect-68785f94cc-qzvrm\n      2023-04-03 23:56:29.980\n      7.842406e+08\n    \n    \n      477\n      rstudio-connect-68785f94cc-qzvrm\n      2023-04-03 23:57:29.980\n      7.842406e+08\n    \n    \n      478\n      rstudio-connect-68785f94cc-qzvrm\n      2023-04-03 23:58:29.980\n      7.882834e+08\n    \n    \n      479\n      rstudio-connect-68785f94cc-qzvrm\n      2023-04-03 23:59:29.980\n      7.882834e+08\n    \n  \n\n480 rows × 3 columns\n\n\n\n\nsource\n\n\nChronicleMetrics.plot\n\n ChronicleMetrics.plot (name:str, alias:str=None)\n\nPlot a selected metric using a Plotly line plot\n\n\n\n\nType\nDefault\nDetails\n\n\n\n\nname\nstr\n\nname of metric to extract\n\n\nalias\nstr\nNone\nalias to use for new column\n\n\nReturns\nline\n\n\n\n\n\n\nm = read_chronicle(\"./data/v1/metrics/\")\np = m.metrics.plot(\"rsconnect_system_memory_used\", \"memory\")\nassert str(type(p)) == \"<class 'plotly.graph_objs._figure.Figure'>\"\n\n\nread_chronicle(\"./data/v1/metrics/\").metrics.plot(\"rsconnect_system_memory_used\", \"memory\")\n\nUnable to display output for mime type(s): application/vnd.plotly.v1+json"
  },
  {
    "objectID": "core.html#analyse-logs",
    "href": "core.html#analyse-logs",
    "title": "core",
    "section": "Analyse logs",
    "text": "Analyse logs\n\nsource\n\nChronicleLogs\n\n ChronicleLogs (df:polars.dataframe.frame.DataFrame)\n\nInitialise a chronicle logs DataFrame\n\n\n\n\nType\nDetails\n\n\n\n\ndf\nDataFrame\nA polars data frame\n\n\nReturns\nDataFrame\n\n\n\n\n\nFilter logs on type\nYou can\n\nsource\n\n\n\nChronicleLogs.filter_type\n\n ChronicleLogs.filter_type (value:str)\n\nExtract all logs where type == value\n\n\n\n\nType\nDetails\n\n\n\n\nvalue\nstr\nValue to extract\n\n\nReturns\nDataFrame\n\n\n\n\n\nlogs = read_chronicle(\"./data/v1/logs\").logs.filter_type(\"username\")\nassert type(logs) == pl.DataFrame\n\n# assert logs\n\n\nread_chronicle(\"./data/v1/logs\").logs.filter_type(\"username\")\n\n\n\nshape: (28, 6)servicehosttimestamp.username.typebodystrstrdatetime[ms]strstrstr\"workbench\"\"rstudio-workbe…2023-04-03 18:01:26.761\"james\"\"session_exit\"\"{\"pid\":236,\"us…\"workbench\"\"rstudio-workbe…2023-04-07 03:46:57.960\"james\"\"auth_login\"\"{\"pid\":1059,\"u…\"workbench\"\"rstudio-workbe…2023-04-07 03:51:15.161\"james\"\"session_start\"\"{\"pid\":236,\"us…\"workbench\"\"rstudio-workbe…2023-04-07 04:19:18.561\"james\"\"session_exit\"\"{\"pid\":236,\"us…\"workbench\"\"rstudio-workbe…2023-04-07 04:19:19.764\"james\"\"session_start\"\"{\"pid\":883,\"us…\"workbench\"\"rstudio-workbe…2023-04-07 05:43:02.161\"james\"\"session_exit\"\"{\"pid\":883,\"us…\"workbench\"\"rstudio-workbe…2023-04-10 13:14:39.961\"james\"\"session_quit\"\"{\"pid\":1781,\"u…\"workbench\"\"rstudio-workbe…2023-04-10 13:15:13.561\"james\"\"session_start\"\"{\"pid\":236,\"us…\"workbench\"\"rstudio-workbe…2023-04-10 13:21:53.361\"james\"\"session_start\"\"{\"pid\":237,\"us…\"workbench\"\"rstudio-workbe…2023-04-10 13:41:46.960\"james\"\"session_exit\"\"{\"pid\":237,\"us…\"workbench\"\"rstudio-workbe…2023-04-10 13:42:07.960\"james\"\"session_start\"\"{\"pid\":236,\"us…\"workbench\"\"rstudio-workbe…2023-04-04 16:21:48.361\"monanshi.shah\"\"auth_login\"\"{\"pid\":1064,\"u…………………\"workbench\"\"rstudio-workbe…2023-04-07 15:01:58.266\"james\"\"session_suspen…\"{\"pid\":1393,\"u…\"workbench\"\"rstudio-workbe…2023-04-07 15:01:58.266\"james\"\"session_exit\"\"{\"pid\":1393,\"u…\"workbench\"\"rstudio-workbe…2023-04-07 15:02:00.264\"james\"\"session_start\"\"{\"pid\":1781,\"u…\"workbench\"\"rstudio-workbe…2023-04-10 13:14:40.064\"james\"\"session_exit\"\"{\"pid\":1781,\"u…\"workbench\"\"rstudio-workbe…2023-04-10 13:15:35.864\"james\"\"session_quit\"\"{\"pid\":236,\"us…\"workbench\"\"rstudio-workbe…2023-04-10 13:15:35.864\"james\"\"session_exit\"\"{\"pid\":236,\"us…\"workbench\"\"rstudio-workbe…2023-04-10 13:41:47.065\"james\"\"session_quit\"\"{\"pid\":237,\"us…\"workbench\"\"rstudio-workbe…2023-04-06 21:44:28.264\"lisa.anders\"\"auth_login\"\"{\"pid\":1065,\"u…\"workbench\"\"rstudio-workbe…2023-04-11 17:14:54.265\"lisa.anders\"\"auth_login\"\"{\"pid\":1061,\"u…\"workbench\"\"rstudio-workbe…2023-04-11 17:17:31.265\"lisa.anders\"\"session_start\"\"{\"pid\":235,\"us…\"workbench\"\"rstudio-workbe…2023-04-11 19:28:52.665\"lisa.anders\"\"session_suspen…\"{\"pid\":235,\"us…\"workbench\"\"rstudio-workbe…2023-04-11 19:28:52.665\"lisa.anders\"\"session_exit\"\"{\"pid\":235,\"us…"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "chronicle",
    "section": "",
    "text": "Experimental - Work in progress\n\n\n\nThe purpose of this experimental package is to expose functionality to make it easy to read, filter and manipulate chronicle parquet files."
  },
  {
    "objectID": "index.html#install",
    "href": "index.html#install",
    "title": "chronicle",
    "section": "Install",
    "text": "Install\nThe package is not yet available on PyPi.\n#| include: False\npip install py_chronicle\nYou can install from github:\npip install git+https://github.com/andrie/py-chronicle"
  },
  {
    "objectID": "index.html#how-chronicle-stores-data",
    "href": "index.html#how-chronicle-stores-data",
    "title": "chronicle",
    "section": "How Chronicle stores data",
    "text": "How Chronicle stores data\nChronicle collects and stores logs and metrics in a series of parquet files.\nUse read_chronicle() to read either logs or metrics, by specifying the path to the parquet set you need.\nThe file tree looks like this, with logs and metrics in separate folders inside v1.\n.\n└── v1/\n    ├── logs/\n    └── metrics/\nInside both logs and metrics the data is stored by date, separated by year, month and day.\n.\n└── v1/\n    ├── logs/\n    │   └── 2023/\n    │       ├── 02/\n    │       │   ├── 01\n    │       │   ├── 02\n    │       │   ├── 03\n    │       │   ├── 04\n    │       │   ├── 05\n    │       │   └── ...\n    │       ├── 03\n    │       ├── 04\n    │       └── ...\n    └── metrics/\n        └── 2023/\n            ├── 02/\n            │   ├── 01\n            │   ├── 02\n            │   ├── 03\n            │   ├── 04\n            │   ├── 05\n            │   └── ...\n            ├── 03\n            ├── 04\n            └── ..."
  },
  {
    "objectID": "index.html#working-with-metrics",
    "href": "index.html#working-with-metrics",
    "title": "chronicle",
    "section": "Working with metrics",
    "text": "Working with metrics\nSome examples.\n\nread_chronicle(\"./data/v1/metrics\").head()\n\n\n\nshape: (5, 13)servicehostosattributesnamedescriptionunittypetimestampvalue_floatvalue_intvalue_uintvalue_columnstrstrstrlist[struct[2]]strstrstrstrdatetime[ms]f64i64u64str\"workbench-metr…\"rstudio-workbe…\"linux\"[{\"host\",\"rstudio-workbench-6b9658c77f-mn8hj\"}]\"rstudio_system…\"Graphite metri…\"\"\"gauge\"2023-04-03 16:02:20.5743.0074e900\"value_float\"\"workbench-metr…\"rstudio-workbe…\"linux\"[{\"host\",\"rstudio-workbench-6b9658c77f-mn8hj\"}]\"rstudio_system…\"Graphite metri…\"\"\"gauge\"2023-04-03 16:02:20.5743.2212e900\"value_float\"\"workbench-metr…\"rstudio-workbe…\"linux\"[{\"host\",\"rstudio-workbench-6b9658c77f-mn8hj\"}]\"rstudio_system…\"Graphite metri…\"\"\"gauge\"2023-04-03 16:02:20.5742.13864448e800\"value_float\"\"connect-metric…\"rstudio-connec…\"linux\"[{\"host\",\"rstudio-connect-68785f94cc-qzvrm\"}]\"rsconnect_syst…\"Graphite metri…\"\"\"gauge\"2023-04-03 16:24:29.9805.7377e900\"value_float\"\"connect-metric…\"rstudio-connec…\"linux\"[{\"host\",\"rstudio-connect-68785f94cc-qzvrm\"}]\"rsconnect_syst…\"Graphite metri…\"\"\"gauge\"2023-04-03 16:24:29.9807.04741376e800\"value_float\"\n\n\n\nread_chronicle(\"./data/v1/metrics/\").metrics.describe()\n\n\n\n\n\n  \n    \n      \n      service\n      name\n      description\n      value_column\n    \n  \n  \n    \n      0\n      connect-metrics\n      rsconnect_system_memory_available\n      [Graphite metric rsconnect_system_memory_avail...\n      [value_float]\n    \n    \n      1\n      connect-metrics\n      rsconnect_system_memory_total\n      [Graphite metric rsconnect_system_memory_total]\n      [value_float]\n    \n    \n      2\n      connect-metrics\n      rsconnect_system_memory_used\n      [Graphite metric rsconnect_system_memory_used]\n      [value_float]\n    \n    \n      3\n      workbench-metrics\n      rstudio_system_memory_available\n      [Graphite metric rstudio_system_memory_available]\n      [value_float]\n    \n    \n      4\n      workbench-metrics\n      rstudio_system_memory_total\n      [Graphite metric rstudio_system_memory_total]\n      [value_float]\n    \n    \n      5\n      workbench-metrics\n      rstudio_system_memory_used\n      [Graphite metric rstudio_system_memory_used]\n      [value_float]\n    \n  \n\n\n\n\n\nread_chronicle(\"./data/v1/metrics/\").metrics.filter(\"rsconnect_system_memory_used\", \"memory\").head()\n\n\n\n\n\n  \n    \n      \n      host\n      timestamp\n      memory\n    \n  \n  \n    \n      0\n      rstudio-connect-68785f94cc-qzvrm\n      2023-04-03 16:00:29.980\n      1.170264e+09\n    \n    \n      1\n      rstudio-connect-68785f94cc-qzvrm\n      2023-04-03 16:01:29.980\n      1.187889e+09\n    \n    \n      2\n      rstudio-connect-68785f94cc-qzvrm\n      2023-04-03 16:02:29.980\n      1.188659e+09\n    \n    \n      3\n      rstudio-connect-68785f94cc-qzvrm\n      2023-04-03 16:03:29.980\n      1.252348e+09\n    \n    \n      4\n      rstudio-connect-68785f94cc-qzvrm\n      2023-04-03 16:04:29.980\n      1.259856e+09\n    \n  \n\n\n\n\n\nread_chronicle(\"./data/v1/metrics/\").metrics.plot(\"rsconnect_system_memory_used\", \"memory\")\n\nUnable to display output for mime type(s): application/vnd.plotly.v1+json"
  },
  {
    "objectID": "index.html#working-with-logs",
    "href": "index.html#working-with-logs",
    "title": "chronicle",
    "section": "Working with logs",
    "text": "Working with logs\nSome examples.\n\nread_chronicle(\"./data/v1/logs\").head()\n\n\n\nshape: (5, 6)servicehostosattributesbodytimestampstrstrstrlist[struct[2]]strdatetime[ms]\"workbench\"\"rstudio-workbe…\"linux\"[{\"data\",\"120\"}, {\"pid\",\"2.36E+02\"}, … {\"type\",\"session_suspend\"}]\"{\"pid\":236,\"us…2023-04-03 18:01:26.665\"workbench\"\"rstudio-workbe…\"linux\"[{\"data\",\"\"}, {\"pid\",\"2.36E+02\"}, … {\"type\",\"session_exit\"}]\"{\"pid\":236,\"us…2023-04-03 18:01:26.761\"connect\"\"rstudio-connec…\"linux\"[{\"user_role\",\"publisher\"}, {\"user_guid\",\"085ba4be-01b5-478b-877c-321368924c89\"}, … {\"type\",\"audit\"}]\"{\"action\":\"add…2023-04-03 19:30:35.698\"connect\"\"rstudio-connec…\"linux\"[{\"log.file.name\",\"audit.json\"}, {\"actor_description\",\"Auth Provider\"}, … {\"entry_id\",\"3.032E+03\"}]\"{\"action\":\"add…2023-04-03 19:30:35.698\"connect\"\"rstudio-connec…\"linux\"[{\"action\",\"add_group_member\"}, {\"actor_id\",\"0E+00\"}, … {\"log.file.name\",\"audit.json\"}]\"{\"action\":\"add…2023-04-03 19:30:35.698\n\n\n\nread_chronicle(\"./data/v1/logs\").logs.filter_type(\"username\").head()\n\n\n\nshape: (5, 6)servicehosttimestamp.username.typebodystrstrdatetime[ms]strstrstr\"workbench\"\"rstudio-workbe…2023-04-03 18:01:26.761\"james\"\"session_exit\"\"{\"pid\":236,\"us…\"workbench\"\"rstudio-workbe…2023-04-07 03:46:57.960\"james\"\"auth_login\"\"{\"pid\":1059,\"u…\"workbench\"\"rstudio-workbe…2023-04-07 03:51:15.161\"james\"\"session_start\"\"{\"pid\":236,\"us…\"workbench\"\"rstudio-workbe…2023-04-07 04:19:18.561\"james\"\"session_exit\"\"{\"pid\":236,\"us…\"workbench\"\"rstudio-workbe…2023-04-07 04:19:19.764\"james\"\"session_start\"\"{\"pid\":883,\"us…"
  }
]